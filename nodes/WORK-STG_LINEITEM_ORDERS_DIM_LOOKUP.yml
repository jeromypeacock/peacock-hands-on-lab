steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: fd3bd182-cf5a-4dfa-9d00-959c2df53709
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 50458860-d641-41ae-8830-869eecfa79f5
                    stepCounter: bb114c51-e94c-4289-9654-839151a47acc
                transform: ""
          - columnReference:
              columnCounter: 225cc19e-14dc-4c4a-a1ae-1df89b5bb59b
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 61b60423-9af4-4fff-9937-03d4dea54a5a
                    stepCounter: 1febc02a-3adf-4b8f-acd1-e4bd83ddb8b1
                transform: ""
          - columnReference:
              columnCounter: 6bd85656-56a2-4603-bf00-6b73ccc98a5a
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 94a898e9-0fa5-4c0a-aa38-d3d0291bd39f
                    stepCounter: ea008e12-5348-4ede-bef0-fd05a7393111
                transform: ""
          - columnReference:
              columnCounter: e6329416-60d2-45b8-a094-50d0be8a9e24
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 00bf75f1-b766-4a90-a022-77c73ccb183e
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 4da93479-754f-4220-b45d-4fcbfd625d03
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3facbe59-7649-4241-8e29-d65112622873
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: d7fe1dec-cccc-4a3f-b77b-1078bab46474
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a32b2748-7ef2-4160-88dd-2493c35ee193
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 3a466b0d-4091-4f37-96f3-b123903f4afd
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a9315e26-9032-43e9-9a03-d6c4e6699ef6
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: a03e893f-b9f1-4e5a-b47a-b08440f8afe5
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 741d507a-1cec-45e0-aa3a-23e1a382ea62
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 4902bf63-5e36-4e5d-8a0c-9e10e7ad819a
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 69ee4f87-118e-49bf-949c-6ee55d9e998e
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 38b50ead-ddd7-4818-9f53-716627f98c5c
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f79d48e0-ddbc-4e4a-a427-7f7f952fe0b4
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: c7aba31f-c92e-430a-923d-da9a980f93b0
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2efd7d5b-403b-4e5a-805a-c4fd5fe209a5
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 12efb9d7-993c-457a-a0ca-0ad58c9cd024
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ea81cbc2-1a0b-4173-bf22-cf88c08f1354
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 16aef52c-02ad-41b9-8565-e54cb6c318f7
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e65de317-0be4-481e-8226-25dfa09425f3
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 367e743f-f690-421b-9c2c-8d4d064dbe68
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eda509f9-fe1d-49b5-bfd8-998d7ed0b461
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: df3f1c33-fdbb-4488-8271-296a424a9e9a
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 71cded79-193c-4372-aa3c-ca343ef93680
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: bcfae877-bf31-4476-bad9-a3eef51e1b4d
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5390660-2a63-407e-b209-da582aa77ceb
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 07efb73c-8f18-43c4-b9a5-f1599b472acf
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 01859e2d-acd3-449a-8dc2-db82c9a652a5
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: b693a928-7e09-4f75-b23e-e963fea22c7c
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 72ec239a-2859-48d2-8c2c-cd93a8bfa0fb
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 3422ce2e-6a0f-40de-b027-dffa8a60d87c
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c4ef1c7e-6f5f-4f71-b19c-64ee8a2161b5
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 44b34831-d740-41a3-bb27-a965f55677f5
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0c5dfa6e-4db0-4120-b9bd-dbc132c1835a
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 9f4bb9ef-ced4-46ad-8551-04eba1070127
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: adafc519-5b7c-4f8c-8694-949a3ba7aa01
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: a51e48cb-6ec6-479b-b553-d1f41cdc31a4
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eeb4c428-beeb-455e-a54c-83dc29cd91ad
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 39164e7c-ba74-4383-9d60-c3ce9e987968
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4f050e03-db8b-48cd-b933-66878fd8104e
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 5621b9ce-a378-45b5-84c4-9bb2c95ebf33
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 758451c8-4e59-4e2e-b61a-dac17a843be6
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 4393df00-db3f-48b5-a8ca-be7540e5bb19
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 252df044-70fe-47fc-a3f7-98e7373437df
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 7511a28a-a828-4c6b-98b2-70aee5c89436
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0cf4c0fa-669e-45e6-a7b0-a40831634754
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 12ee6b2c-c450-4fd8-a37c-8108854db8c5
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fe54138a-0041-4c44-9446-1f717fd12d28
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 355817d0-5987-4e35-b070-f079d739745e
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5ebd820d-86c5-4997-9793-9a97b5dac740
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 656f3db5-2726-4941-8c78-58f652ef4b3d
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1d772f7e-2d75-4cd5-b6d6-2be3cceadcc4
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - columnReference:
              columnCounter: 7deebecc-05d6-4b6a-9094-2ea319fa8883
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10c9489b-b294-49fc-a336-e8d14f07b536
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 2a32e125-eb72-479f-9387-0767a57a37d4
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 24360faa-aa21-48c5-b471-f0138a8cb451
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a868666f-00f0-4766-a45d-c2d4d6829d3b
              stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a1c65bf6-de0e-4db2-b4bf-895924dd322c
                    stepCounter: a57699b9-3b98-4625-8861-4510f0821348
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: bb114c51-e94c-4289-9654-839151a47acc
              DIM_PART: 1febc02a-3adf-4b8f-acd1-e4bd83ddb8b1
              DIM_SUPPLIER: ea008e12-5348-4ede-bef0-fd05a7393111
              STG_LINEITEM_ORDERS: a57699b9-3b98-4625-8861-4510f0821348
              STG_PARTSUPP: afe4cbf9-2aef-45a3-996d-86c66096d971
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 1a0df366-e8a3-40e0-9c58-ad0e1b3cb55c
